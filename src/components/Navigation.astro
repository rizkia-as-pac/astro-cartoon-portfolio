---
import { siteConfig } from "../config/site";

const base = import.meta.env.BASE_URL;
const currentPath = Astro.url.pathname;

// helper kecil biar aman untuk GitHub Pages base path
const withBase = (path: string) => `${base}${path.replace(/^\//, "")}`;

// Active state harus compare pakai base-aware path
const isActive = (path: string) => currentPath === withBase(path);
const isActivePrefix = (path: string) => currentPath.startsWith(withBase(path));
---

<nav>
  <a href={withBase("/")} class="site-name">{siteConfig.name}</a>

  <ul class="nav-menu">
    <li>
      <a href={withBase("/")} class={`menu-link ${isActive("/") ? "active" : ""}`}>
        {siteConfig.navigation.home}
      </a>
    </li>

    <li>
      <a
        href={withBase("/projects")}
        class={`menu-link ${isActivePrefix("/projects") ? "active" : ""}`}
      >
        {siteConfig.navigation.projects}
      </a>
    </li>

    <li>
      <a
        href={withBase("/posts")}
        class={`menu-link ${isActivePrefix("/posts") ? "active" : ""}`}
      >
        {siteConfig.navigation.posts}
      </a>
    </li>

    <li>
      <a
        href={withBase("/contact")}
        class={`menu-link ${isActivePrefix("/contact") ? "active" : ""}`}
      >
        {siteConfig.navigation.contact}
      </a>
    </li>

    <li>
      <a
        href={withBase("/comments")}
        class={`menu-link ${isActivePrefix("/comments") ? "active" : ""}`}
      >
        {siteConfig.navigation.comments}
      </a>
    </li>

    <li>
      {(() => {
        const resumeHref = siteConfig.resume || "";
        const isExternal = /^https?:\/\//i.test(resumeHref);
        const href = isExternal ? resumeHref : withBase(resumeHref || "/resume");

        return (
          <a
            href={href}
            target={isExternal ? "_blank" : undefined}
            rel={isExternal ? "noopener noreferrer" : undefined}
            class={`menu-link ${!isExternal && isActivePrefix("/resume") ? "active" : ""}`}
          >
            {siteConfig.navigation.resume}
          </a>
        );
      })()}
    </li>
  </ul>
</nav>

